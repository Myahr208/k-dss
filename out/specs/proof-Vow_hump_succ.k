requires "../rules.k"

module PROOF-VOW_HUMP_SUCC
  imports ETHEREUM-SIMULATION
  imports EVM
  imports RULES

// Vow_hump
rule
  <k> #execute ~> CONTINUATION => #halt ~> CONTINUATION </k>
  <exit-code> 1 </exit-code>
  <mode> NORMAL </mode>
  <schedule> BYZANTIUM </schedule>
  <analysis> .Map </analysis>
  <ethereum>
    <evm>
      <output> _ => #asByteStackInWidthaux(Hump, 31, 32, .WordStack) </output>
      <statusCode> _ => EVMC_SUCCESS </statusCode>
      <callStack> VCallStack </callStack>
      <interimStates> _ </interimStates>
      <touchedAccounts> _ => _ </touchedAccounts>
      <callState>
        <program> #asMapOpCodes(#dasmOpCodes(#parseByteStack("0x608060405234801561001057600080fd5b507c01000000000000000000000000000000000000000000000000000000006000350463bf353dbb8114156100575761004c6004356000610877565b805460405260206040f35b6365fae35e8114156100885761006b610860565b1561007557600080fd5b6100826004356000610877565b60018155005b639c52a7f18114156100b95761009c610860565b156100a657600080fd5b6100b36004356000610877565b60008155005b6336569e778114156100d15760015460405260206040f35b63dfbf306d8114156100e95760025460405260206040f35b6370904ded8114156101015760035460405260206040f35b637f49edc48114156101255761011a6004356004610877565b805460405260206040f35b63d0adc35f81141561013d5760055460405260206040f35b632a1d2b3c8114156101555760075460405260206040f35b6364bd701381141561016d5760085460405260206040f35b63c349d3628114156101855760095460405260206040f35b6368110b2f81141561019d57600a5460405260206040f35b631b8e8cfa8114156101b557600b5460405260206040f35b6329ae8114811415610299576101c9610860565b156101d357600080fd5b7f77616974000000000000000000000000000000000000000000000000000000006004351415610204576024356008555b7f73756d70000000000000000000000000000000000000000000000000000000006004351415610235576024356009555b7f62756d7000000000000000000000000000000000000000000000000000000000600435141561026657602435600a555b7f68756d7000000000000000000000000000000000000000000000000000000000600435141561029757602435600b555b005b63d4e8be8381141561034c576102ad610860565b156102b757600080fd5b7f666c61700000000000000000000000000000000000000000000000000000000060043514156102e8576024356002555b7f666c6f70000000000000000000000000000000000000000000000000000000006004351415610319576024356003555b7f7661740000000000000000000000000000000000000000000000000000000000600435141561034a576024356001555b005b6305db453881141561036957610360610769565b60405260206040f35b6307a832b48114156103865761037d6107d2565b60405260206040f35b6349dd5bb28114156103a35761039a61083b565b60405260206040f35b63697efb788114156103ee576103b7610860565b156103c157600080fd5b6103cc426004610877565b6103d9600435825461088e565b81556103e960043560055461088e565b600555005b6335aee16f811415610438574261040960085460043561088e565b111561041457600080fd5b6104216004356004610877565b805461042f816005546108a8565b60055560008255005b63f37ac61c8114156104b45761045c6b033b2e3c9fd0803ce80000006004356108c2565b600081121561046a57600080fd5b7f990a5f630000000000000000000000000000000000000000000000000000000060005230600452306024528060445260008060646000806001545af115156104b257600080fd5b005b632506855a811415610542576007546104db6b033b2e3c9fd0803ce80000006004356108c2565b60008112156104e957600080fd5b6104f5600435836108a8565b6007557f990a5f630000000000000000000000000000000000000000000000000000000060005230600452306024528060445260008060646000806001545af1151561054057600080fd5b005b63bbbb0d7b8114156105f9576009548061055a61083b565b101561056557600080fd5b600061056f6107d2565b14151561057b57600080fd5b6105878160075461088e565b6007557fb7e9cd2400000000000000000000000000000000000000000000000000000000600052306004527fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff602452806044526020604060646000806003545af115156105f357600080fd5b60206040f35b630e01198b81141561076457600a54610624600b5461061f8361061a610769565b61088e565b61088e565b61062c6107d2565b101561063757600080fd5b600061064161083b565b14151561064d57600080fd5b7ff4b9fa75000000000000000000000000000000000000000000000000000000006000526020604060046000806002545af1151561068a57600080fd5b6040517fa3b22fc4000000000000000000000000000000000000000000000000000000006000526002546004526000806024600080855af115156106cd57600080fd5b7fb7e9cd2400000000000000000000000000000000000000000000000000000000600052306004528160245260006044526020604060646000806002545af1151561071757600080fd5b6040517fdc4d20fa000000000000000000000000000000000000000000000000000000006000526002546004526000806024600080865af1151561075a57600080fd5b8060405260206040f35b600080fd5b60007fa60f1d3e00000000000000000000000000000000000000000000000000000000600052306004526020600060246000806001545af115156107ac57600080fd5b60005160008110156107bd57600080fd5b6b033b2e3c9fd0803ce8000000810491505090565b60007ff53e4e6900000000000000000000000000000000000000000000000000000000600052306004526020600060246000806001545af1151561081557600080fd5b600051600081101561082657600080fd5b6b033b2e3c9fd0803ce8000000810491505090565b600061085b600754610856600554610851610769565b6108a8565b6108a8565b905090565b600061086d336000610877565b5460011415905090565b600082600052816020526040600020905092915050565b60008282019050818110156108a257600080fd5b92915050565b60008282039050818111156108bc57600080fd5b92915050565b600082820290508183820414600084141715156108de57600080fd5b929150505600a165627a7a723058203ef3c7bfd72f2b08e93392cfe20bb7adf37abebb59c39ac3d71375c0c616f2c70029"), BYZANTIUM)) </program>
        <programBytes> #parseByteStack("0x608060405234801561001057600080fd5b507c01000000000000000000000000000000000000000000000000000000006000350463bf353dbb8114156100575761004c6004356000610877565b805460405260206040f35b6365fae35e8114156100885761006b610860565b1561007557600080fd5b6100826004356000610877565b60018155005b639c52a7f18114156100b95761009c610860565b156100a657600080fd5b6100b36004356000610877565b60008155005b6336569e778114156100d15760015460405260206040f35b63dfbf306d8114156100e95760025460405260206040f35b6370904ded8114156101015760035460405260206040f35b637f49edc48114156101255761011a6004356004610877565b805460405260206040f35b63d0adc35f81141561013d5760055460405260206040f35b632a1d2b3c8114156101555760075460405260206040f35b6364bd701381141561016d5760085460405260206040f35b63c349d3628114156101855760095460405260206040f35b6368110b2f81141561019d57600a5460405260206040f35b631b8e8cfa8114156101b557600b5460405260206040f35b6329ae8114811415610299576101c9610860565b156101d357600080fd5b7f77616974000000000000000000000000000000000000000000000000000000006004351415610204576024356008555b7f73756d70000000000000000000000000000000000000000000000000000000006004351415610235576024356009555b7f62756d7000000000000000000000000000000000000000000000000000000000600435141561026657602435600a555b7f68756d7000000000000000000000000000000000000000000000000000000000600435141561029757602435600b555b005b63d4e8be8381141561034c576102ad610860565b156102b757600080fd5b7f666c61700000000000000000000000000000000000000000000000000000000060043514156102e8576024356002555b7f666c6f70000000000000000000000000000000000000000000000000000000006004351415610319576024356003555b7f7661740000000000000000000000000000000000000000000000000000000000600435141561034a576024356001555b005b6305db453881141561036957610360610769565b60405260206040f35b6307a832b48114156103865761037d6107d2565b60405260206040f35b6349dd5bb28114156103a35761039a61083b565b60405260206040f35b63697efb788114156103ee576103b7610860565b156103c157600080fd5b6103cc426004610877565b6103d9600435825461088e565b81556103e960043560055461088e565b600555005b6335aee16f811415610438574261040960085460043561088e565b111561041457600080fd5b6104216004356004610877565b805461042f816005546108a8565b60055560008255005b63f37ac61c8114156104b45761045c6b033b2e3c9fd0803ce80000006004356108c2565b600081121561046a57600080fd5b7f990a5f630000000000000000000000000000000000000000000000000000000060005230600452306024528060445260008060646000806001545af115156104b257600080fd5b005b632506855a811415610542576007546104db6b033b2e3c9fd0803ce80000006004356108c2565b60008112156104e957600080fd5b6104f5600435836108a8565b6007557f990a5f630000000000000000000000000000000000000000000000000000000060005230600452306024528060445260008060646000806001545af1151561054057600080fd5b005b63bbbb0d7b8114156105f9576009548061055a61083b565b101561056557600080fd5b600061056f6107d2565b14151561057b57600080fd5b6105878160075461088e565b6007557fb7e9cd2400000000000000000000000000000000000000000000000000000000600052306004527fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff602452806044526020604060646000806003545af115156105f357600080fd5b60206040f35b630e01198b81141561076457600a54610624600b5461061f8361061a610769565b61088e565b61088e565b61062c6107d2565b101561063757600080fd5b600061064161083b565b14151561064d57600080fd5b7ff4b9fa75000000000000000000000000000000000000000000000000000000006000526020604060046000806002545af1151561068a57600080fd5b6040517fa3b22fc4000000000000000000000000000000000000000000000000000000006000526002546004526000806024600080855af115156106cd57600080fd5b7fb7e9cd2400000000000000000000000000000000000000000000000000000000600052306004528160245260006044526020604060646000806002545af1151561071757600080fd5b6040517fdc4d20fa000000000000000000000000000000000000000000000000000000006000526002546004526000806024600080865af1151561075a57600080fd5b8060405260206040f35b600080fd5b60007fa60f1d3e00000000000000000000000000000000000000000000000000000000600052306004526020600060246000806001545af115156107ac57600080fd5b60005160008110156107bd57600080fd5b6b033b2e3c9fd0803ce8000000810491505090565b60007ff53e4e6900000000000000000000000000000000000000000000000000000000600052306004526020600060246000806001545af1151561081557600080fd5b600051600081101561082657600080fd5b6b033b2e3c9fd0803ce8000000810491505090565b600061085b600754610856600554610851610769565b6108a8565b6108a8565b905090565b600061086d336000610877565b5460011415905090565b600082600052816020526040600020905092915050565b60008282019050818110156108a257600080fd5b92915050565b60008282039050818111156108bc57600080fd5b92915050565b600082820290508183820414600084141715156108de57600080fd5b929150505600a165627a7a723058203ef3c7bfd72f2b08e93392cfe20bb7adf37abebb59c39ac3d71375c0c616f2c70029") </programBytes>
        <id> ACCT_ID </id>
        <caller> CALLER_ID </caller>
        <callData> #abiCallData("hump", .TypedArgs) </callData>
        <callValue> 0 </callValue>
        <wordStack> .WordStack => _ </wordStack>
        <localMem> .Map => _ </localMem>
        <pc> 0 => _ </pc>
        <gas> VGas => _ </gas>
        <memoryUsed> 0 => _ </memoryUsed>
        <previousGas> _ => _ </previousGas>
        <static> false </static>
        <callDepth> VCallDepth => _ </callDepth>
      </callState>
      <substate>
        <selfDestruct> VSelfDestruct </selfDestruct>
        <log> _ => VLog </log>
        <refund> _ => VRefund </refund>
      </substate>
      <gasPrice> _ </gasPrice>
      <origin> ORIGIN_ID </origin>
      <previousHash> _ </previousHash>
      <ommersHash> _ </ommersHash>
      <coinbase> _ </coinbase>
      <stateRoot> _ </stateRoot>
      <transactionsRoot> _ </transactionsRoot>
      <receiptsRoot> _ </receiptsRoot>
      <logsBloom> _ </logsBloom>
      <difficulty> _ </difficulty>
      <number> _ </number>
      <gasLimit> _ </gasLimit>
      <gasUsed> _ </gasUsed>
      <timestamp> TIME </timestamp>
      <extraData> _ </extraData>
      <mixHash> _ </mixHash>
      <blockNonce> _ </blockNonce>
      <ommerBlockHeaders> _ </ommerBlockHeaders>
      <blockhash> _ </blockhash>
    </evm>
    <network>
      <activeAccounts> SetItem(ACCT_ID) _ </activeAccounts>
      <accounts>
        <account>
          <acctID> ACCT_ID </acctID>
          <balance> BAL </balance>
          <code> #parseByteStack("0x608060405234801561001057600080fd5b507c01000000000000000000000000000000000000000000000000000000006000350463bf353dbb8114156100575761004c6004356000610877565b805460405260206040f35b6365fae35e8114156100885761006b610860565b1561007557600080fd5b6100826004356000610877565b60018155005b639c52a7f18114156100b95761009c610860565b156100a657600080fd5b6100b36004356000610877565b60008155005b6336569e778114156100d15760015460405260206040f35b63dfbf306d8114156100e95760025460405260206040f35b6370904ded8114156101015760035460405260206040f35b637f49edc48114156101255761011a6004356004610877565b805460405260206040f35b63d0adc35f81141561013d5760055460405260206040f35b632a1d2b3c8114156101555760075460405260206040f35b6364bd701381141561016d5760085460405260206040f35b63c349d3628114156101855760095460405260206040f35b6368110b2f81141561019d57600a5460405260206040f35b631b8e8cfa8114156101b557600b5460405260206040f35b6329ae8114811415610299576101c9610860565b156101d357600080fd5b7f77616974000000000000000000000000000000000000000000000000000000006004351415610204576024356008555b7f73756d70000000000000000000000000000000000000000000000000000000006004351415610235576024356009555b7f62756d7000000000000000000000000000000000000000000000000000000000600435141561026657602435600a555b7f68756d7000000000000000000000000000000000000000000000000000000000600435141561029757602435600b555b005b63d4e8be8381141561034c576102ad610860565b156102b757600080fd5b7f666c61700000000000000000000000000000000000000000000000000000000060043514156102e8576024356002555b7f666c6f70000000000000000000000000000000000000000000000000000000006004351415610319576024356003555b7f7661740000000000000000000000000000000000000000000000000000000000600435141561034a576024356001555b005b6305db453881141561036957610360610769565b60405260206040f35b6307a832b48114156103865761037d6107d2565b60405260206040f35b6349dd5bb28114156103a35761039a61083b565b60405260206040f35b63697efb788114156103ee576103b7610860565b156103c157600080fd5b6103cc426004610877565b6103d9600435825461088e565b81556103e960043560055461088e565b600555005b6335aee16f811415610438574261040960085460043561088e565b111561041457600080fd5b6104216004356004610877565b805461042f816005546108a8565b60055560008255005b63f37ac61c8114156104b45761045c6b033b2e3c9fd0803ce80000006004356108c2565b600081121561046a57600080fd5b7f990a5f630000000000000000000000000000000000000000000000000000000060005230600452306024528060445260008060646000806001545af115156104b257600080fd5b005b632506855a811415610542576007546104db6b033b2e3c9fd0803ce80000006004356108c2565b60008112156104e957600080fd5b6104f5600435836108a8565b6007557f990a5f630000000000000000000000000000000000000000000000000000000060005230600452306024528060445260008060646000806001545af1151561054057600080fd5b005b63bbbb0d7b8114156105f9576009548061055a61083b565b101561056557600080fd5b600061056f6107d2565b14151561057b57600080fd5b6105878160075461088e565b6007557fb7e9cd2400000000000000000000000000000000000000000000000000000000600052306004527fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff602452806044526020604060646000806003545af115156105f357600080fd5b60206040f35b630e01198b81141561076457600a54610624600b5461061f8361061a610769565b61088e565b61088e565b61062c6107d2565b101561063757600080fd5b600061064161083b565b14151561064d57600080fd5b7ff4b9fa75000000000000000000000000000000000000000000000000000000006000526020604060046000806002545af1151561068a57600080fd5b6040517fa3b22fc4000000000000000000000000000000000000000000000000000000006000526002546004526000806024600080855af115156106cd57600080fd5b7fb7e9cd2400000000000000000000000000000000000000000000000000000000600052306004528160245260006044526020604060646000806002545af1151561071757600080fd5b6040517fdc4d20fa000000000000000000000000000000000000000000000000000000006000526002546004526000806024600080865af1151561075a57600080fd5b8060405260206040f35b600080fd5b60007fa60f1d3e00000000000000000000000000000000000000000000000000000000600052306004526020600060246000806001545af115156107ac57600080fd5b60005160008110156107bd57600080fd5b6b033b2e3c9fd0803ce8000000810491505090565b60007ff53e4e6900000000000000000000000000000000000000000000000000000000600052306004526020600060246000806001545af1151561081557600080fd5b600051600081101561082657600080fd5b6b033b2e3c9fd0803ce8000000810491505090565b600061085b600754610856600554610851610769565b6108a8565b6108a8565b905090565b600061086d336000610877565b5460011415905090565b600082600052816020526040600020905092915050565b60008282019050818110156108a257600080fd5b92915050565b60008282039050818111156108bc57600080fd5b92915050565b600082820290508183820414600084141715156108de57600080fd5b929150505600a165627a7a723058203ef3c7bfd72f2b08e93392cfe20bb7adf37abebb59c39ac3d71375c0c616f2c70029") </code>
          <storage> (_:Map
                      (#Vow.hump |-> (Hump)))
           </storage>
          <nonce> _ </nonce>
        </account>
       ... 
      </accounts>
      <txOrder> _ </txOrder>
      <txPending> _ </txPending>
      <messages> _ </messages>
    </network>
  </ethereum>
requires #rangeAddress(ACCT_ID)
andBool #notPrecompileAddress(ACCT_ID)
andBool #rangeAddress(CALLER_ID)
andBool #rangeAddress(ORIGIN_ID)
andBool #rangeUInt(48, TIME)
andBool #rangeUInt(256, BAL)
andBool VCallDepth <=Int 1024

    andBool (#rangeUInt(256, Hump)
    andBool (VGas >Int 300000))

endmodule
